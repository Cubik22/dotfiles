#!/bin/sh

# this script is usually run in river/init
# it spawns foot in tag 1
# firefox in tag 9
# and if firefox is composed of two windows the second one in tag 8
# chromium/firefox-soft in tag 7
# and if chromium/firefox-soft is composed of two windows the second one in tag 6

get_tags() {
    echo "$((1 << ($1 - 1)))"
}

footclient_pos=1
browser_normal_first_pos=9
browser_normal_second_pos=8
browser_soft_first_pos=7
browser_soft_second_pos=6

# sleep before setting view tags otherwise window is not focused
# sleep again for some time, river has to change the tag assigned to the window

if command -v "chromium" >/dev/null 2>&1; then
# if [ -d "$HOME/.mozilla/firefox/soft" ]; then
    riverctl set-focused-tags "$(get_tags $browser_soft_second_pos)"
    chromium-wayland &
    # firefox -P soft &
    sleep 2
    riverctl set-view-tags "$(get_tags $browser_soft_first_pos)"
    sleep 1
fi

riverctl set-focused-tags "$(get_tags $browser_normal_second_pos)"
firefox &
sleep 2
riverctl set-view-tags "$(get_tags $browser_normal_first_pos)"
sleep 1

riverctl set-focused-tags "$(get_tags $footclient_pos)"
footclient &

# load audio status
# it is done here in order to wait for pipewire to load in the backgroud
# if done before pipewire then resets audio status

## set audio volume
# pactl set-sink-volume @DEFAULT_SINK@ 20%
## set audio status to off
toggle-volume audio off
## load audio status
# toggle-volume audio load

## set microphone volume
pactl set-source-volume @DEFAULT_SOURCE@ 20%
## set microphone status to off
toggle-volume microphone off
## load microphone status
# toggle-volume microphone load
